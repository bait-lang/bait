// Copyright (c) 2023-present Lukas Neubert and contributors (see AUTHORS.md).
// This Source Code is subject to the terms of the Mozilla Public License 2.0.

import os

fun test_error_in_outs() {
	tests_dir := os.dir($FILE)
	in_out_dir := '${tests_dir}/tests'
	in_files := os.walk_ext(in_out_dir, '.in.bt')

	for file in in_files {
		name_ext := os.file_name(file)
		name := name_ext.all_before('.in.bt')

		out_file := '${in_out_dir}/${name}.out'
		assert os.exists(out_file)

		expected := os.read_file(out_file)
		res := os.exec('node ${$BAITEXE} --nocolor --script ${file}')
		assert expected == res.stderr
	}
}
