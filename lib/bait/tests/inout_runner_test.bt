// Copyright (c) 2023-present Lukas Neubert.
// This Source Code is subject to the terms of the Mozilla Public License 2.0.

import os
import bait.util.testing

const DIR := os.dir($FILE)

const ERR_SKIP := [
	// Known fail due to regression
	'lib/bait/tests/inout_error/array/magic_methods.in.bt'
]

fun test_in_outs() {
	testing.in_out_runner(testing.InOutRunner{
		root = '${DIR}/inout'
		check_stdout = true
	})
}

fun test_error_in_outs() {
	testing.in_out_runner(testing.InOutRunner{
		root = '${DIR}/inout_error'
		cmd_options = '--script'
		skips = ERR_SKIP
	})
}

fun test_in_outs_with_options() {
	root := '${DIR}/inout_opts'

	testing.in_out_runner(testing.InOutRunner{
		root = '${root}/no_script'
	})

	testing.in_out_runner(testing.InOutRunner{
		root = '${root}/warn_error'
		cmd_options = '--script -W'
	})

	testing.in_out_runner(testing.InOutRunner{
		root = '${root}/no_warn'
		cmd_options = '--script -w'
	})
}
