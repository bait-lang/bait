// Copyright (c) 2023-present Lukas Neubert and contributors (see AUTHORS.md).
// This Source Code Form is subject to the terms of the Mozilla Public License 2.0.
package main

import os

fun main() {
	if not os.ARGS.contains('--no-backup') {
		os.cp($BAITEXE, 'old_bait.js')
	}
	res := os.exec('node ${$BAITEXE} cli/bait.bt -o bait.js')
	if res.stderr.length > 0 {
		eprintln(res.stderr)
	}
	if res.code != 0 {
		eprintln('"bait self" failed:')
		exit(1)
	}
	println('Bait compiled successfully into "bait.js"')
}
